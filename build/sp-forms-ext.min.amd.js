define(["jquery"],function($){

"use strict";var SPFormsExt=function(e){var t=this,i={fieldNames:{},changedCheckInterval:1e3};$.extend(this.settings,i,e),$('[id$="_Picker_OuterTable"]').each(function(){var e=$(this);setInterval(function(){t.checkIfBusinessDataChanged(e)},t.settings.changedCheckInterval)})};$.extend(SPFormsExt.prototype,{settings:{fieldNames:{}},checkIfBusinessDataChangedCache:{},lookupFieldName:function(e){return e in this.settings.fieldNames?this.settings.fieldNames[e]:e},setField:function(e,t){var i=this.getFieldType(e);switch(i){case"checkbox":this.setCheckbox(e,t);break;case"peoplepicker":this.setPeoplePicker(e,t);break;case"select":this.setSelect(e,t);break;case"BusinessData":this.setBusinessDataField(e,t);break;case"taxonomy":this.setTaxonomy(e,t);break;default:this.setInput(e,t)}},findBodyFromFieldName:function(e){var t=this;return $('.ms-formlabel .ms-standardheader:contains("'+t.lookupFieldName(e)+'")').filter(function(i,n){var s=$(n).text().replace("*","").trim();return s===t.lookupFieldName(e)?!0:void 0}).closest("tr").find(".ms-formbody")},setBusinessDataField:function(e,t){if(!t)return!1;var i=this.findBodyFromFieldName(e);i.find('[id$="Picker_upLevelDiv"]').text(t),i.find('[id$="Picker_checkNames"]').click()},getBusinessDataField:function(e){var t=this.findBodyFromFieldName(e);return t.find('[id$="_Picker_OuterTable"]')},setInput:function(e,t){var i=this.findBodyFromFieldName(e);i.find("input").val(t)},getFieldType:function(e){var t=this.findBodyFromFieldName(e);if(!t)throw new Error("fieldBody not found.");return t.find(".ms-taxonomy").length?"taxonomy":t.find('[type="checkbox"]').length?"checkbox":t.find('[id$="ClientPeoplePicker"]').length?"peoplepicker":t.find('[id$="_Picker_OuterTable"]').length?"BusinessData":t.find("select").length?"select":void 0},setSelect:function(e,t){if(!t)return!1;var i=this.findBodyFromFieldName(e);i.find("select option").filter(function(){return $(this).text()===t}).attr("selected",!0)},setTaxonomy:function(e,t){var i=this,n=i.findBodyFromFieldName(e);n.find('[id$="_$containereditableRegion"]').text(t)},setCheckbox:function(e,t){var i=this,n=i.findBodyFromFieldName(e);n.find('[type="checkbox"]').prop("checked",t)},findPeoplePicker:function(e){var t=$('[id$="ClientPeoplePicker"][title="'+e+'"]'),i=t.find('[title="'+e+'"]'),n=SPClientPeoplePicker.SPClientPeoplePickerDict[t[0].id];return{div:t,editor:i,sp:n}},setPeoplePicker:function(e,t){if(!t)return!1;var i=this.findPeoplePicker(e);i.editor.val(t),i.sp.AddUnresolvedUserFromEditor(!0)},getPeoplePicker:function(e){var t=this.findPeoplePicker(e);return t.sp.GetAllUserInfo()},findBusinessDataValue:function(e,t){var i=$.parseXML(e),n=$(i).find('Key:contains("'+t+'")').parent().find("Value").text();return n},getFieldName:function(e){return e.closest("tr").find(".ms-formlabel .ms-standardheader").text().replace("*","").trim()},checkIfBusinessDataChanged:function(e){var t=$("#divEntityData div",e).attr("data"),i=e.attr("id");t!==this.checkIfBusinessDataChangedCache[i]&&(this.checkIfBusinessDataChangedCache[i]=t,e.trigger("change",t))}});
return SPFormsExt;

});
